import matplotlib.pyplot as plt
import numpy as np
from PIL import Image

baselineErrors = [0.1109,  0.2170,  0.3325,  0.4554,  0.5806,  0.7103,  0.8421,
         0.9774,  1.1184,  1.2654,  1.4191,  1.5803,  1.7493,  1.9259,
         2.1108,  2.3050,  2.5094,  2.7248,  2.9504,  3.1874,  3.4357,
         3.6946,  3.9643,  4.2442,  4.5364]  0.5806,  1.2654  2.1108 3.1874 4.5364

baselineErrors3Sec = [0.1109,  0.2170,  0.3325,  0.4554,  0.5806,  0.7103,  0.8421,
         0.9774,  1.1184,  1.2654,  1.4191,  1.5803,  1.7493,  1.9259,
         2.1108]
baselineErrors3SecTime = range(0,30,2)

vanillaLSTMwithConvTrainDataLatError = [0.16808538, 0.16060122, 0.20162988, 0.28791308, 0.37554009, 0.4594749,
 0.53958969, 0.61256372, 0.68095129, 0.74212334, 0.79812341, 0.8507261,
 0.90113081, 0.95557925, 1.01408703, 1.07572503, 1.13982142, 1.2079372,
 1.28507636, 1.37051553, 1.4593626, 1.54626903, 1.62564121, 1.6924223,
 1.74212741, 1.76719529, 1.76725903, 1.75405642, 1.73596536, 1.7228522]
vanillaLSTMwithConvTrainDataLonError = [0.61751866, 0.61038414, 0.60442643, 0.6609783, 0.70665946, 0.75281683,
 0.81078912, 0.88244267, 0.9777278, 1.10036404, 1.24387059, 1.3985095,
 1.56061184, 1.72512965, 1.89430145, 2.06724725, 2.24288136, 2.41604145,
 2.59082861, 2.77116371, 2.95483246, 3.14083937, 3.32966192, 3.51794833,
 3.70731191, 3.90503584, 4.11764698, 4.36728709, 4.65940694, 5.06376851]
vanillaLSTMwithConvTrainDataTotalError = [0.66118752, 0.66223313, 0.68960912, 0.78872417, 0.88529754, 0.98335203,
 1.08983834, 1.20768662, 1.34056563, 1.4899421, 1.65464629, 1.82952984,
 2.01115197, 2.1983889, 2.39174446, 2.58964556, 2.79279785, 2.99799374,
 3.20974763, 3.425954, 3.6427905, 3.85901255, 4.07225213, 4.27807663,
 4.47614787, 4.66875158, 4.86127742, 5.07743554, 5.32967529, 5.68651571,]

vanillaLSTMwithConvTestDataLatError = [0.12784893, 0.12413788, 0.17404118, 0.25299738, 0.35040085, 0.45212811,
 0.53558015, 0.61187087, 0.68798684, 0.75816062, 0.81955099, 0.8722531,
 0.92195817, 0.97847031, 1.04700253, 1.12773986, 1.21343344, 1.30492559,
 1.40622382, 1.50901493, 1.60799954, 1.69617473, 1.76796157, 1.8096704,
 1.81645664, 1.78545022, 1.73480565, 1.67895216, 1.62744246, 1.58333986]
vanillaLSTMwithConvTestDataLonError = [0.74186612, 0.77707523, 0.80158902, 0.85622529, 0.91668939, 0.99881017,
 1.09926106, 1.20807806, 1.33921196, 1.48839033, 1.66023897, 1.83663298,
 2.00682119, 2.16939079, 2.32853735, 2.49723071, 2.66785722, 2.8400812,
 3.01187529, 3.18420913, 3.36804935, 3.55448195, 3.74409417, 3.93730992,
 4.13866987, 4.35314916, 4.61412457, 4.96431726, 5.40103232, 5.97954498]
vanillaLSTMwithConvTestDataTotalError = [0.76304203, 0.80129538, 0.84551457, 0.93904017, 1.05085675, 1.19028794,
 1.3397713, 1.49220129, 1.66467646, 1.85124043, 2.05013984, 2.2515363,
 2.44776919, 2.64336922, 2.84495909, 3.06078165, 3.28277406, 3.51192234,
 3.74782729, 3.9834126, 4.21845302, 4.4454148 , 4.66238261, 4.86193988,
 5.04417841, 5.2160533, 5.41304373, 5.67602753, 6.02926938, 6.53452378]

# ConvLSTMTrainDataLatError = []
# ConvLSTMTrainDataLonError = []
# ConvLSTMTrainDataTotalError = []

# ConvLSTMTestDataLatError = []
# ConvLSTMTestDataLonError = []
# ConvLSTMTestDataTotalError = []


plt.plot(baselineErrors3SecTime,baselineErrors3Sec, '--', label='baseline')

#plt.plot(vanillaLSTMwithConvTrainDataLatError, marker='o', label='Stacked LSTM Lat Error (Train Data)')
#plt.plot(vanillaLSTMwithConvTrainDataLonError, marker='o', label='Stacked LSTM Lon Error (Train Data)')
plt.plot(vanillaLSTMwithConvTrainDataTotalError, marker='o', label='Stacked LSTM Total Error (Train Data)')

#plt.plot(vanillaLSTMwithConvTestDataLatError, marker='+', label='Stacked LSTM Lat Error (Test Data)')
#plt.plot(vanillaLSTMwithConvTestDataLonError, marker='+', label='Stacked LSTM Lon Error (Test Data)')
plt.plot(vanillaLSTMwithConvTestDataTotalError, marker='+', label='Stacked LSTM Total Error (Test Data)')

# plt.plot(ConvLSTMTrainDataLatError, marker='s', label='ConvLSTM Lat Error (Train Data)')
# plt.plot(ConvLSTMTrainDataLonError, marker='s', label='ConvLSTM Lon Error (Train Data)')
#plt.plot(ConvLSTMTrainDataTotalError, marker='s', label='ConvLSTM Total Error (Train Data)')

plt.xlabel('Frame Count', fontsize=14)
plt.ylabel('RMSE (meters)', fontsize=14)
plt.xticks(fontsize=14)
plt.yticks(fontsize=14)
plt.legend(fontsize=14)
plt.grid()
plt.show()


#Stacked LSTM Train data error

# Frame Total Errors
# [0.66118752 0.66223313 0.68960912 0.78872417 0.88529754 0.98335203
#  1.08983834 1.20768662 1.34056563 1.4899421  1.65464629 1.82952984
#  2.01115197 2.1983889  2.39174446 2.58964556 2.79279785 2.99799374
#  3.20974763 3.425954   3.6427905  3.85901255 4.07225213 4.27807663
#  4.47614787 4.66875158 4.86127742 5.07743554 5.32967529 5.68651571]
# Frame Lon Errors
# [0.61751866 0.61038414 0.60442643 0.6609783  0.70665946 0.75281683
#  0.81078912 0.88244267 0.9777278  1.10036404 1.24387059 1.3985095
#  1.56061184 1.72512965 1.89430145 2.06724725 2.24288136 2.41604145
#  2.59082861 2.77116371 2.95483246 3.14083937 3.32966192 3.51794833
#  3.70731191 3.90503584 4.11764698 4.36728709 4.65940694 5.06376851]
# Frame Lat Errors
# [0.16808538 0.16060122 0.20162988 0.28791308 0.37554009 0.4594749
#  0.53958969 0.61256372 0.68095129 0.74212334 0.79812341 0.85072617
#  0.90113081 0.95557925 1.01408703 1.07572503 1.13982142 1.20793728
#  1.28507636 1.37051553 1.4593626  1.54626903 1.62564121 1.6924223
#  1.74212741 1.76719529 1.76725903 1.75405642 1.73596536 1.72285222]

#Stacked LSTM Test data error
# Frame Total Errors
# [0.76304203 0.80129538 0.84551457 0.93904017 1.05085675 1.19028794
#  1.3397713  1.49220129 1.66467646 1.85124043 2.05013984 2.2515363
#  2.44776919 2.64336922 2.84495909 3.06078165 3.28277406 3.51192234
#  3.74782729 3.9834126  4.21845302 4.4454148  4.66238261 4.86193988
#  5.04417841 5.2160533  5.41304373 5.67602753 6.02926938 6.53452378]
# Frame Lon Errors
# [0.74186612 0.77707523 0.80158902 0.85622529 0.91668939 0.99881017
#  1.09926106 1.20807806 1.33921196 1.48839033 1.66023897 1.83663298
#  2.00682119 2.16939079 2.32853735 2.49723071 2.66785722 2.8400812
#  3.01187529 3.18420913 3.36804935 3.55448195 3.74409417 3.93730992
#  4.13866987 4.35314916 4.61412457 4.96431726 5.40103232 5.97954498]
# Frame Lat Errors
# [0.12784893 0.12413788 0.17404118 0.25299738 0.35040085 0.45212811
#  0.53558015 0.61187087 0.68798684 0.75816062 0.81955099 0.8722531
#  0.92195817 0.97847031 1.04700253 1.12773986 1.21343344 1.30492559
#  1.40622382 1.50901493 1.60799954 1.69617473 1.76796157 1.8096704
#  1.81645664 1.78545022 1.73480565 1.67895216 1.62744246 1.58333986]



# Highres normal convolution
# Frame Total Errors
# [0.38421357 0.4333408  0.51057998 0.58290101 0.65577527 0.73913799
#  0.83316467 0.93826998 1.05203835 1.17588648 1.31173089 1.45833402
#  1.61413678 1.77610217 1.94244361 2.11384708 2.28674689 2.45770146
#  2.63002573 2.80523208 2.99034785 3.18641607 3.3813772  3.57049947
#  3.75638915 3.94888176 4.13807675 4.3328069  4.51332864 4.69411443]
# Frame Lon Errors
# [0.37333224 0.4071121  0.46722974 0.52095005 0.57469956 0.6419475
#  0.72300067 0.81728577 0.92318233 1.04187309 1.17321519 1.31591927
#  1.46812891 1.62820662 1.79298901 1.96283766 2.13389978 2.3024254
#  2.47168679 2.6439381  2.82650891 3.01997528 3.21275129 3.40016481
#  3.58429429 3.7754662  3.96243461 4.15372235 4.3303316  4.5062465 ]
# Frame Lat Errors
# [0.04236214 0.07741911 0.11623149 0.15554351 0.19196665 0.22425667
#  0.25080417 0.27453912 0.29561265 0.31471293 0.33323056 0.35204594
#  0.37072398 0.38847405 0.40629678 0.42474777 0.44287865 0.46134009
#  0.48090445 0.50123573 0.52252111 0.54292859 0.56146746 0.57740916
#  0.59042954 0.60262736 0.61613231 0.63304111 0.65245715 0.67388726]



normal
0.09086851 0.20573125 0.32260892 0.46557886 0.59136867 0.70879609
 0.82412234 0.9679964  1.09130344 1.21640568 1.34359385 1.47799415
 1.60881975 1.7365038  1.88045949 2.01100348 2.14650977 2.28180679
 2.41472776 2.55046418 2.68554054 2.81303215 2.94605301 3.07270981
 3.20316646 3.33754947 3.47233028 3.60825033 3.7395505  3.87302676

Constant Velocity

[0.01696568 0.04701369 0.08764025 0.13673825 0.19406261 0.25975927
 0.33239068 0.41168461 0.49731835 0.58827958 0.68411752 0.78463577
 0.88895854 0.99627744 1.10589179 1.2179242  1.33309492 1.45177869
 1.57447874 1.70169535 1.83276273 1.96757321 2.10636674 2.24923996
 2.39679072 2.54875502 2.70499999 2.86494423 3.02791724 3.1929918
 3.35946392 3.52737009 3.69772106 3.8705292  4.04621989 4.22398339
 4.40327756 4.58368446 4.76495489 4.9468205  5.12939746 5.31307707
 5.4983536  5.68554176 5.8740632  6.06360811 6.25357112 6.44397754
 6.63483609 6.88652247]


 [0.01696568         0.04701369 0.08764025 0.13673825 0.19406261 0.25975927
 0.33239068 0.41168461 0.49731835 0.58827958        0.68411752      0.78463577
 0.88895854 0.99627744 1.10589179 1.2179242  1.33309492 1.45177869
 1.57447874 1.70169535        1.83276273        1.96757321 2.10636674 2.24923996
 2.39679072 2.54875502 2.70499999 2.86494423 3.02791724 3.1929918
       3.35946392             3.52737009 3.69772106 3.8705292  4.04621989 4.22398339
 4.40327756 4.58368446 4.76495489 4.9468205         5.12939746        5.31307707
 5.4983536  5.68554176 5.8740632  6.06360811 6.25357112 6.44397754
 6.63483609 6.88652247]   0.58827958   1.70169535   3.1929918   4.9468205   6.88652247
 
 Constant Velocity *************

 [0.01962325 0.05450676 0.10216636 0.16075947 0.22936856 0.30780274
 0.39472255 0.48900382 0.59010088 0.69656053 0.80736316 0.92236527
 1.04091653 1.16120577 1.28344878 1.40732999 1.53356664 1.662425
 1.79353166 1.92760018 2.06505826 2.20569504 2.34978886 2.49835372
 2.65216501 2.81103596 2.97488407 3.14264266 3.3134372  3.48643194
 3.66065269 3.83599424 4.01323987 4.19208253 4.37272537 4.55482324
 4.73706984 4.91951322 5.10159569 5.28228144 5.46219626 5.64222141
 5.82332201 6.00561402 6.1886038  6.37232177 6.55632706 6.74041417
 6.9244071  7.1085893 ]


OGM LeakyLSTM (144,169)
 Error count 1134
[0.07134857 0.14052322 0.23846902 0.32817468 0.4411882  0.55326808
 0.67400634 0.80269482 0.93160192 1.05552723 1.18685784 1.3212747
 1.44056669 1.56852476 1.69726476 1.81743991 1.94706329 2.06971209
 2.19675078 2.32116949 2.44254326 2.56758872 2.68894862 2.80786159
 2.92389341 3.04605838 3.15737086 3.27344846 3.39041956 3.50887477
 3.63610895 3.76421094 3.89933918 4.04881654 4.2103156  4.37481157
 4.55096234 4.72580382 4.90065207 5.06955022 5.24329169 5.41164651
 5.57881118 5.74204553 5.90007714 6.0626754  6.2182972  6.37062297
 6.52291926 6.67451506]

 bestModel OGM (121, 144) old one

 [0.09910587 0.18374245 0.2671686  0.35660362 0.43069987 0.52351934
 0.61104341 0.69873819 0.78534167 0.87050959 0.97073781 1.05841567
 1.14855134 1.23722996 1.32552349 1.41637781 1.50431296 1.59582088
 1.68610116 1.76959553 1.861755   1.94807718 2.03815732 2.11787719
 2.19488129 2.27851943 2.35258023 2.42762391 2.50067818 2.5822175
 2.65882429 2.72819586 2.80571526 2.88871269 2.9700405  3.04257855
 3.11858453 3.19997958 3.26968877 3.34513601 3.42298902 3.5031786
 3.57999255 3.66040104 3.74103928 3.82238499 3.90328592 3.9838574
 4.06478941 4.14820123]
 0.87  1.76 2.58 3.34 4.14
 

 traj to traj 3 sec 

 Global Error Count = 1177
[0.07631233 0.15501797 0.2410398  0.33079613 0.42197523 0.5132153
 0.60767998 0.70257208 0.8010934  0.90008065 0.99851766 1.09745438
 1.20004769 1.30096708 1.40126804 1.50682719 1.61242422 1.72157963
 1.82870281 1.94041643 2.05323044 2.16635661 2.27780682 2.39179806
 2.50476547 2.62187115 2.73591162 2.85337843 2.96678019 3.08152989]


 traj to traj 5 sec 

 Global Error Count = 1137
[0.07638458 0.15445633 0.23956194 0.32798261 0.41725759 0.50770426
 0.60103278 0.69435132 0.79141186 0.88872298 0.98605072 1.08459892
 1.1865469  1.28726787 1.38716482 1.49164903 1.59632516 1.70399671
 1.80977289 1.92052328 2.03280778 2.14518554 2.25662363 2.37062283
 2.48377505 2.6012885  2.71524507 2.83283173 2.94622404 3.06172508
 3.17424504 3.29222422 3.40963154 3.53160185 3.65598637 3.77666815
 3.90235809 4.02867487 4.15853573 4.28729777 4.41949442 4.55195416
 4.68561474 4.82228874 4.95884605 5.0957689  5.23197759 5.37193603
 5.51053655 5.65236211]  0.88872298  1.92052328  3.06172508  4.28729777 5.65236211

 traj to traj 5 sec ************** Test
 [0.08644589 0.17855958 0.27033024 0.3747604  0.47018276 0.56944234
 0.67894167 0.77857387 0.88046421 0.980157   1.08618046 1.18955335
 1.29496548 1.41002214 1.51621501 1.62381713 1.73929329 1.84782674
 1.96000324 2.07345496 2.19316641 2.30660951 2.42090964 2.54084271
 2.65791411 2.778172   2.89905701 3.02667593 3.14921066 3.27246723
 3.40059543 3.52703758 3.66024286 3.7952046  3.92720981 4.06275226
 4.19723146 4.33620219 4.47032753 4.60626923 4.74555716 4.88225919
 5.01723215 5.15413901 5.29435657 5.4370601  5.57687168 5.72036035
 5.86030684 6.00428906]



 Test Data (159 142) ogm 

 Error count 1023
[0.09457022 0.19878244 0.31201979 0.44609437 0.59103693 0.7342851
 0.8963953  1.05316682 1.21558327 1.3770566  1.53131801 1.68312076
 1.83712743 1.99006211 2.13078992 2.2793769  2.43163598 2.57420846
 2.71621039 2.85959215 3.00110374 3.13941281 3.27107479 3.40490981
 3.53543507 3.66315636 3.78081096 3.90700243 4.0247336  4.14098418
 4.25945854 4.39247559 4.5284975  4.68362114 4.84512067 5.01183812
 5.18354208 5.34805586 5.51638622 5.68219432 5.8422915  5.99831726
 6.15014587 6.30492486 6.44610457 6.58870596 6.72497765 6.8592482
 6.98890208 7.11427983]


 othersetting

 [0.08396848 0.12930315 0.19177639 0.25085377 0.32153353 0.41210709
 0.49645174 0.58464351 0.68157232 0.76953986 0.86163112 0.95748336
 1.04550622 1.13783301 1.22324203 1.31904101 1.40176056 1.48723425
 1.58420743 1.66932906 1.75537468 1.84926621 1.94804891 2.03567747
 2.1298606  2.22930929 2.32263112 2.41424226 2.50515522 2.59869488
 2.68550077 2.77804928 2.87716149 2.98312136 3.10199117 3.22491194
 3.36276946 3.49507159 3.63557172 3.7753819  3.90182702 4.03186534
 4.15513675 4.27512969 4.38288838 4.49337512 4.60103327 4.70900369
 4.81791873 4.92956227]

 Leaky Relu Ngsim 0.76953986   1.66932906 2.59869488 3.7753819  4.92956227

 [0.08396848 0.12930315 0.19177639 0.25085377 0.32153353 0.41210709
 0.49645174 0.58464351 0.68157232 0.76953986 0.86163112 0.95748336
 1.04550622 1.13783301 1.22324203 1.31904101 1.40176056 1.48723425
 1.58420743 1.66932906 1.75537468 1.84926621 1.94804891 2.03567747
 2.1298606  2.22930929 2.32263112 2.41424226 2.50515522 2.59869488
 2.68550077 2.77804928 2.87716149 2.98312136 3.10199117 3.22491194
 3.36276946 3.49507159 3.63557172 3.7753819  3.90182702 4.03186534
 4.15513675 4.27512969 4.38288838 4.49337512 4.60103327 4.70900369
 4.81791873 4.92956227]    othersetting

 Relu Ngsim 0.76953986   1.66932906 2.59869488 3.7753819  4.92956227

 Leaky Relu Ngsim  & 0.87 & 1.76 & 2.58 & 3.34 & \textbf{4.14} \\



